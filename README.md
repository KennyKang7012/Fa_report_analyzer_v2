# FA Report Analyzer - 使用說明

## 📋 專案簡介

FA Report Analyzer 是一個專業的失效分析報告評估工具,使用 AI 技術對 FA 報告進行全面、客觀的評分與分析。

### 主要功能
- ✅ 自動讀取多種格式的 FA 報告 (TXT, PDF, DOCX)
- ✅ 使用 Claude AI 進行智能分析
- ✅ 六大維度評估,涵蓋報告的所有關鍵要素
- ✅ 自動生成結構化評估報告
- ✅ 提供具體的改善建議

### 評估維度
1. **基本資訊完整性** (15%)
2. **問題描述與定義** (15%)
3. **分析方法與流程** (20%)
4. **數據與證據支持** (20%)
5. **根因分析** (20%)
6. **改善對策** (10%)

## 🔧 安裝與設置

### 系統需求
- Python 3.8 或更高版本
- pip 套件管理器

### 安裝步驟

#### 1. 安裝基本依賴套件
```bash
pip install anthropic pandas --break-system-packages
```

#### 2. (選用) 安裝文件讀取套件

**如果需要讀取 PDF 文件:**
```bash
pip install PyPDF2 --break-system-packages
```

**如果需要讀取 Word 文件:**
```bash
pip install python-docx --break-system-packages
```

#### 3. 取得 API Key

如果你在本地環境執行,需要 Anthropic API key:
- 前往 https://console.anthropic.com/
- 註冊並取得 API key
- 使用 `-k` 參數傳入 API key

**注意:** 如果在 claude.ai 的 Computer Use 環境中,不需要提供 API key

## 📖 使用方法

### 基本用法

```bash
# 分析 TXT 格式的 FA 報告
python fa_report_analyzer.py -i sample_fa_report.txt

# 分析 PDF 格式的 FA 報告
python fa_report_analyzer.py -i fa_report.pdf -o evaluation.txt

# 使用 API key (本地環境)
python fa_report_analyzer.py -i fa_report.pdf -k YOUR_API_KEY
```

### 參數說明

| 參數 | 說明 | 必填 |
|------|------|------|
| `-i, --input` | 輸入的 FA 報告文件路徑 | ✓ |
| `-o, --output` | 輸出的評估報告路徑 (預設自動生成) | ✗ |
| `-k, --api-key` | Anthropic API key | ✗ |

### 支援的文件格式

- `.txt` - 純文字檔案
- `.pdf` - PDF 文件 (需要 PyPDF2)
- `.docx` - Word 文件 (需要 python-docx)

## 💡 使用範例

### 範例 1: 快速分析

```bash
# 使用提供的範例報告
python fa_report_analyzer.py -i sample_fa_report.txt
```

輸出:
```
================================================================================
FA 報告分析工具
================================================================================

[1/3] 讀取報告文件: sample_fa_report.txt
✓ 成功讀取報告 (3250 字元)

[2/3] 使用 AI 進行深度分析...
✓ 分析完成

[3/3] 生成評估報告...
✓ 評估報告已保存至: fa_evaluation_20241120_143025.txt

================================================================================
分析完成!
================================================================================

總分: 85.5 分
等級: B
```

### 範例 2: 指定輸出文件

```bash
python fa_report_analyzer.py -i my_fa_report.pdf -o my_evaluation.txt
```

### 範例 3: 在本地使用 (需要 API key)

```bash
export ANTHROPIC_API_KEY="your_api_key_here"
python fa_report_analyzer.py -i fa_report.pdf -k $ANTHROPIC_API_KEY
```

## 📊 評估報告格式

生成的評估報告包含以下部分:

### 1. 總分與等級
```
【總分與等級】
總分: 85.5 分
等級: B 級 - 良好報告
```

### 2. 各維度評分表
```
【各維度評分表】
--------------------------------------------------------------------------------
評估維度         權重    得分    完成度    評語
基本資訊完整性   15%    13.5    90.0%    資訊完整,包含所有必要欄位
問題描述與定義   15%    12.8    85.3%    描述清晰,失效現象記錄詳細
...
```

### 3. 優點分析
```
【優點分析】
1. 報告結構完整,包含所有必要章節
2. 根因分析使用了系統化的 5-Why 方法
3. 改善對策分為短中長期,具有可操作性
...
```

### 4. 待改進項目
```
【待改進項目】(依優先級排序)

1. [高優先級] 缺少對照組數據
   改善建議: 建議增加良品的對照測試數據,強化分析的對比性

2. [中優先級] 統計分析不足
   改善建議: 建議加入更多統計分析,如 Cpk 值、信賴區間等
...
```

### 5. 總評與建議
```
【總評與建議】
這是一份良好的 FA 報告,展現了專業的分析能力...
```

## 🎯 評分標準

| 等級 | 分數範圍 | 說明 |
|------|----------|------|
| A | 90-100 | 卓越報告 - 所有維度表現優異 |
| B | 80-89 | 良好報告 - 主要維度表現良好 |
| C | 70-79 | 合格報告 - 基本要求達標 |
| D | 60-69 | 待改進報告 - 多個維度不足 |
| F | <60 | 不合格報告 - 關鍵資訊缺失 |

## 🔍 程式架構

```python
FAReportAnalyzer
├── __init__()              # 初始化分析器
├── read_report()           # 讀取報告文件
├── create_analysis_prompt() # 創建 AI 分析提示詞
├── analyze_with_ai()       # 使用 AI 進行分析
├── calculate_grade()       # 計算等級
├── generate_report()       # 生成評估報告
└── analyze_report()        # 完整分析流程
```

## 📝 自訂與擴展

### 修改評估維度權重

編輯 `fa_report_analyzer.py` 中的 `dimensions` 字典:

```python
self.dimensions = {
    "基本資訊完整性": 20,  # 從 15% 改為 20%
    "問題描述與定義": 15,
    "分析方法與流程": 20,
    "數據與證據支持": 15,  # 從 20% 改為 15%
    "根因分析": 20,
    "改善對策": 10
}
```

### 修改評分標準

編輯 `grade_criteria` 字典:

```python
self.grade_criteria = {
    'A': (95, 100, '卓越報告'),  # 提高 A 級門檻
    'B': (85, 94, '良好報告'),
    'C': (75, 84, '合格報告'),
    'D': (65, 74, '待改進報告'),
    'F': (0, 64, '不合格報告')
}
```

## 🐛 常見問題

### Q1: 無法讀取 PDF 文件

**問題:** 執行時出現 "需要安裝 PyPDF2" 錯誤

**解決方案:**
```bash
pip install PyPDF2 --break-system-packages
```

### Q2: API 錯誤

**問題:** "API key not found" 或連接失敗

**解決方案:**
1. 檢查 API key 是否正確
2. 確認網路連接正常
3. 在 claude.ai 環境中不需要提供 API key

### Q3: JSON 解析錯誤

**問題:** "JSON 解析錯誤"

**解決方案:**
這通常是因為 AI 回應格式不符預期。程式會自動處理,如果仍有問題,請檢查:
- 報告內容是否完整
- 文件編碼是否為 UTF-8

### Q4: 記憶體不足

**問題:** 處理大型 PDF 時記憶體不足

**解決方案:**
- 將 PDF 轉換為文字格式
- 分段處理大型報告

## 📞 技術支援

### 功能建議
如有功能建議或改進意見,歡迎提出反饋

### 錯誤回報
請提供:
1. 錯誤訊息
2. 輸入文件範例
3. 執行環境資訊 (Python 版本、作業系統)

## 📄 授權

此工具供內部使用,請勿外流

---

**版本:** 1.0.0
**更新日期:** 2024-11-20
**開發者:** KennyKang (Semiconductor FA Engineer)
